/**
 * spatial-controls v3.0.5 build Sat Dec 26 2020
 * https://github.com/vanruesc/spatial-controls
 * Copyright 2020 Raoul van RÃ¼schen
 * @license Zlib
 */
var SPATIALCONTROLS=(()=>{var W=Object.create,k=Object.defineProperty,Q=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty,H=Object.getOwnPropertyNames,Z=Object.getOwnPropertyDescriptor,G=t=>k(t,"__esModule",{value:!0}),q=(t,n)=>{G(t);for(var i in n)k(t,i,{get:n[i],enumerable:!0})},j=(t,n,i)=>{if(G(t),n&&typeof n=="object"||typeof n=="function")for(let e of H(n))!X.call(t,e)&&e!=="default"&&k(t,e,{get:()=>n[e],enumerable:!(i=Z(n,e))||i.enumerable});return t},P=t=>t&&t.__esModule?t:j(k(t!=null?W(Q(t)):{},"default",{value:t,enumerable:!0}),t),$={};q($,{Action:()=>r,Direction:()=>l,GeneralSettings:()=>p,KeyBindings:()=>g,KeyCode:()=>h,MovementState:()=>O,MovementStrategy:()=>c,PointerButton:()=>m,PointerSettings:()=>v,RotationManager:()=>D,RotationSettings:()=>E,SensitivitySettings:()=>M,Settings:()=>A,SpatialControls:()=>I,TranslationManager:()=>w,TranslationSettings:()=>S,ZoomSettings:()=>b,ZoomStrategy:()=>T});var r;(function(t){t[t.MOVE_FORWARD=0]="MOVE_FORWARD",t[t.MOVE_LEFT=1]="MOVE_LEFT",t[t.MOVE_BACKWARD=2]="MOVE_BACKWARD",t[t.MOVE_RIGHT=3]="MOVE_RIGHT",t[t.MOVE_DOWN=4]="MOVE_DOWN",t[t.MOVE_UP=5]="MOVE_UP",t[t.ZOOM_OUT=6]="ZOOM_OUT",t[t.ZOOM_IN=7]="ZOOM_IN"})(r||(r={}));var V=P(require("three")),m;(function(t){t[t.MAIN=0]="MAIN",t[t.AUXILIARY=1]="AUXILIARY",t[t.SECONDARY=2]="SECONDARY"})(m||(m={}));var O=class{constructor(){this.reset()}reset(){return this.left=!1,this.right=!1,this.forward=!1,this.backward=!1,this.up=!1,this.down=!1,this}},f=P(require("three")),J=Math.PI*2,x=new f.Vector3,N=new f.Matrix4,D=class{constructor(n,i,e,s){this.position=n,this.quaternion=i,this.target=e,this.settings=s,this.spherical=new f.Spherical}setPosition(n){return this.position=n,this}setQuaternion(n){return this.quaternion=n,this}setTarget(n){return this.target=n,this}updateQuaternion(){let n=this.settings,i=n.rotation;return n.general.orbit?N.lookAt(x.subVectors(this.position,this.target),i.pivotOffset,i.up):N.lookAt(x.set(0,0,0),this.target.setFromSpherical(this.spherical),i.up),this.quaternion.setFromRotationMatrix(N),this}adjustSpherical(n,i){let e=this.settings,s=e.general.orbit,o=e.rotation,a=this.spherical;return a.theta=o.invertX?a.theta+n:a.theta-n,a.phi=(s||o.invertY)&&!(s&&o.invertY)?a.phi-i:a.phi+i,a.theta=Math.min(Math.max(a.theta,o.minAzimuthalAngle),o.maxAzimuthalAngle),a.phi=Math.min(Math.max(a.phi,o.minPolarAngle),o.maxPolarAngle),a.theta%=J,a.makeSafe(),s&&this.position.setFromSpherical(a).add(this.target),this}zoom(n){let i=this.settings,e=i.general,s=i.sensitivity,o=i.zoom,a=this.spherical;if(e.orbit&&o.enabled){let u=n*s.zoom;o.invert&&(u=-u);let _=Math.max(o.minDistance,1e-6),z=Math.min(o.maxDistance,Number.POSITIVE_INFINITY);a.radius=Math.min(Math.max(a.radius+u,_),z),this.position.setFromSpherical(a).add(this.target)}return this}update(n){}lookAt(n){let i=this.spherical,e=this.position,s=this.target;return s.copy(n),this.settings.general.orbit?x.subVectors(e,s):x.subVectors(s,e).normalize(),i.setFromVector3(x),i.radius=Math.max(i.radius,1e-6),this.updateQuaternion(),this}getViewDirection(n){return n.setFromSpherical(this.spherical).normalize(),this.settings.general.orbit&&n.negate(),n}},Y=P(require("three")),R=P(require("three")),F=new R.Vector3(1,0,0),L=new R.Vector3(0,1,0),d=new R.Vector3(0,0,1),B=new Y.Vector3,w=class{constructor(n,i,e,s){this.position=n,this.quaternion=i,this.target=e,this.settings=s,this.movementState=new O}setPosition(n){return this.position=n,this}setQuaternion(n){return this.quaternion=n,this}setTarget(n){return this.target=n,this}translateOnAxis(n,i){B.copy(n).applyQuaternion(this.quaternion).multiplyScalar(i),this.position.add(B),this.settings.general.orbit&&this.target.add(B)}translate(n){let i=this.settings.sensitivity,e=this.movementState,s=n*i.translation;e.backward?this.translateOnAxis(d,s):e.forward&&this.translateOnAxis(d,-s),e.right?this.translateOnAxis(F,s):e.left&&this.translateOnAxis(F,-s),e.up?this.translateOnAxis(L,s):e.down&&this.translateOnAxis(L,-s)}update(n){this.settings.translation.enabled&&this.translate(n)}moveTo(n){return this.settings.general.orbit?this.target.copy(n):this.position.copy(n),this}},h;(function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_1=49]="DIGIT_1",t[t.DIGIT_2=50]="DIGIT_2",t[t.DIGIT_3=51]="DIGIT_3",t[t.DIGIT_4=52]="DIGIT_4",t[t.DIGIT_5=53]="DIGIT_5",t[t.DIGIT_6=54]="DIGIT_6",t[t.DIGIT_7=55]="DIGIT_7",t[t.DIGIT_8=56]="DIGIT_8",t[t.DIGIT_9=57]="DIGIT_9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META_LEFT=91]="META_LEFT",t[t.META_RIGHT=92]="META_RIGHT",t[t.SELECT=93]="SELECT",t[t.NUMPAD_0=96]="NUMPAD_0",t[t.NUMPAD_1=97]="NUMPAD_1",t[t.NUMPAD_2=98]="NUMPAD_2",t[t.NUMPAD_3=99]="NUMPAD_3",t[t.NUMPAD_4=100]="NUMPAD_4",t[t.NUMPAD_5=101]="NUMPAD_5",t[t.NUMPAD_6=102]="NUMPAD_6",t[t.NUMPAD_7=103]="NUMPAD_7",t[t.NUMPAD_8=104]="NUMPAD_8",t[t.NUMPAD_9=105]="NUMPAD_9",t[t.MULTIPLY=106]="MULTIPLY",t[t.ADD=107]="ADD",t[t.SUBTRACT=109]="SUBTRACT",t[t.DECIMAL_POINT=110]="DECIMAL_POINT",t[t.DIVIDE=111]="DIVIDE",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.SEMICOLON=186]="SEMICOLON",t[t.EQUAL_SIGN=187]="EQUAL_SIGN",t[t.COMMA=188]="COMMA",t[t.DASH=189]="DASH",t[t.PERIOD=190]="PERIOD",t[t.FORWARD_SLASH=191]="FORWARD_SLASH",t[t.GRAVE_ACCENT=192]="GRAVE_ACCENT",t[t.OPEN_BRACKET=219]="OPEN_BRACKET",t[t.BACK_SLASH=220]="BACK_SLASH",t[t.CLOSE_BRACKET=221]="CLOSE_BRACKET",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE"})(h||(h={}));var p=class{constructor(){this.orbit=!0}copy(n){return this.orbit=n.orbit,this}clone(){let n=new p;return n.copy(this)}},g=class{constructor(){this.defaultActions=new Map,this.actions=new Map}reset(){return this.actions=new Map(this.defaultActions),this}setDefault(n){return this.defaultActions=n,this.reset()}copy(n){return this.defaultActions=new Map(n.defaultActions),this.actions=new Map(n.actions),this}clearDefault(){return this.defaultActions.clear(),this}clear(){return this.actions.clear(),this}clone(){let n=new g;return n.copy(this)}has(n){return this.actions.has(n)}get(n){return this.actions.get(n)}set(n,i){return this.actions.set(n,i),this}delete(n){return this.actions.delete(n)}toJSON(){return{defaultActions:[...this.defaultActions],actions:[...this.actions]}}},v=class{constructor(){this.hold=!1,this.lock=!0}copy(n){return this.hold=n.hold,this.lock=n.lock,this}clone(){let n=new v;return n.copy(this)}},U=P(require("three")),E=class{constructor(){this.up=new U.Vector3,this.up.copy(L),this.pivotOffset=new U.Vector3,this.minAzimuthalAngle=Number.NEGATIVE_INFINITY,this.maxAzimuthalAngle=Number.POSITIVE_INFINITY,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.invertX=!1,this.invertY=!1}copy(n){return this.up.copy(n.up),this.pivotOffset.copy(n.pivotOffset),this.minAzimuthalAngle=n.minAzimuthalAngle,this.maxAzimuthalAngle=n.maxAzimuthalAngle,this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=n.maxPolarAngle,this.invertX=n.invertX,this.invertY=n.invertY,this}clone(){let n=new E;return n.copy(this)}},M=class{constructor(){this.rotationX=1,this.rotationY=1,this.translation=1,this.zoom=1}set rotation(n){this.rotationX=this.rotationY=n}copy(n){return this.rotationX=n.rotationX,this.rotationY=n.rotationY,this.translation=n.translation,this.zoom=n.zoom,this}clone(){let n=new M;return n.copy(this)}},S=class{constructor(){this.enabled=!0}copy(n){return this.enabled=n.enabled,this}clone(){let n=new S;return n.copy(this)}},b=class{constructor(){this.enabled=!0,this.invert=!1,this.minDistance=1e-6,this.maxDistance=Infinity}copy(n){return this.enabled=n.enabled,this.invert=n.invert,this.minDistance=n.minDistance,this.maxDistance=n.maxDistance,this}clone(){let n=new b;return n.copy(this)}},A=class{constructor(){this.general=new p,this.keyBindings=new g,this.keyBindings.setDefault(new Map([[h.W,r.MOVE_FORWARD],[h.UP,r.MOVE_FORWARD],[h.A,r.MOVE_LEFT],[h.LEFT,r.MOVE_LEFT],[h.S,r.MOVE_BACKWARD],[h.DOWN,r.MOVE_BACKWARD],[h.D,r.MOVE_RIGHT],[h.RIGHT,r.MOVE_RIGHT],[h.X,r.MOVE_DOWN],[h.SPACE,r.MOVE_UP],[h.PAGE_DOWN,r.ZOOM_OUT],[h.PAGE_UP,r.ZOOM_IN]])),this.pointer=new v,this.rotation=new E,this.sensitivity=new M,this.translation=new S,this.zoom=new b}copy(n){return this.general.copy(n.general),this.keyBindings.copy(n.keyBindings),this.pointer.copy(n.pointer),this.rotation.copy(n.rotation),this.sensitivity.copy(n.sensitivity),this.translation.copy(n.translation),this.zoom.copy(n.zoom),this}clone(){let n=new A;return n.copy(this)}toDataURL(){return URL.createObjectURL(new Blob([JSON.stringify(this)],{type:"text/json"}))}},c=class{constructor(n,i){this.movementState=n,this.direction=i}execute(n){let i=this.movementState;switch(this.direction){case l.FORWARD:i.forward=n;break;case l.LEFT:i.left=n;break;case l.BACKWARD:i.backward=n;break;case l.RIGHT:i.right=n;break;case l.DOWN:i.down=n;break;case l.UP:i.up=n;break}}},l;(function(t){t[t.FORWARD=0]="FORWARD",t[t.LEFT=1]="LEFT",t[t.BACKWARD=2]="BACKWARD",t[t.RIGHT=3]="RIGHT",t[t.DOWN=4]="DOWN",t[t.UP=5]="UP"})(l||(l={}));var T=class{constructor(n,i){this.rotationManager=n,this.zoomIn=i}execute(n){n&&this.rotationManager.zoom(this.zoomIn?-1:1)}},I=class{constructor(n=null,i=null,e=document.body){this.domElement=e,this.position=n,this.quaternion=i,this.target=new V.Vector3,this.settings=new A,this.rotationManager=new D(n,i,this.target,this.settings),this.translationManager=new w(n,i,this.target,this.settings);let s=this.translationManager.movementState;this.strategies=new Map([[r.MOVE_FORWARD,new c(s,l.FORWARD)],[r.MOVE_LEFT,new c(s,l.LEFT)],[r.MOVE_BACKWARD,new c(s,l.BACKWARD)],[r.MOVE_RIGHT,new c(s,l.RIGHT)],[r.MOVE_DOWN,new c(s,l.DOWN)],[r.MOVE_UP,new c(s,l.UP)],[r.ZOOM_OUT,new T(this.rotationManager,!1)],[r.ZOOM_IN,new T(this.rotationManager,!0)]]),this.lastScreenPosition=new V.Vector2,this.dragging=!1,this.enabled=!1,n!==null&&i!==null&&(this.lookAt(this.target),e!==null&&this.setEnabled())}getDomElement(){return this.domElement}setDomElement(n){let i=this.enabled;return n!==null&&(i&&this.setEnabled(!1),this.domElement=n,this.setEnabled(i)),this}getPosition(){return this.position}setPosition(n){return this.position=n,this.rotationManager.setPosition(n),this.translationManager.setPosition(n),this.lookAt(this.target)}getQuaternion(){return this.quaternion}setQuaternion(n){return this.quaternion=n,this.rotationManager.setQuaternion(n),this.translationManager.setQuaternion(n),this.lookAt(this.target)}getTarget(n){return n.copy(this.target),this.settings.general.orbit||n.add(this.position),n}setTarget(n){return this.target=n,this.rotationManager.setTarget(n),this.translationManager.setTarget(n),this.lookAt(this.target)}getViewDirection(n){return this.rotationManager.getViewDirection(n)}setOrbitEnabled(n){let i=this.settings.general;return i.orbit!==n&&(this.getTarget(this.target),i.orbit=n,this.lookAt(this.target)),this}copy(n){return this.domElement=n.getDomElement(),this.position=n.getPosition(),this.quaternion=n.getQuaternion(),this.target=n.getTarget(new V.Vector3),this.settings.copy(n.settings),this.rotationManager.setPosition(this.position).setQuaternion(this.quaternion).setTarget(this.target),this.translationManager.setPosition(this.position).setQuaternion(this.quaternion).setTarget(this.target),this.lookAt(this.target)}clone(){let n=new I;return n.copy(this)}handlePointerMoveEvent(n){let i=this.settings,e=i.pointer,s=i.sensitivity,o=this.rotationManager,a=this.lastScreenPosition;if(document.pointerLockElement===this.domElement)(!e.hold||this.dragging)&&o.adjustSpherical(n.movementX*.001*s.rotationX,n.movementY*.001*s.rotationY).updateQuaternion();else{let u=n.screenX-a.x,_=n.screenY-a.y;a.set(n.screenX,n.screenY),o.adjustSpherical(u*.001*s.rotationX,_*.001*s.rotationY).updateQuaternion()}}handleTouchMoveEvent(n){let i=this.settings.sensitivity,e=this.rotationManager,s=this.lastScreenPosition,o=n.touches[0],a=o.screenX-s.x,u=o.screenY-s.y;s.set(o.screenX,o.screenY),n.preventDefault(),e.adjustSpherical(a*.001*i.rotationX,u*.001*i.rotationY).updateQuaternion()}handleMainPointerButton(n,i){this.dragging=i,this.settings.pointer.lock?this.setPointerLocked():i?(this.lastScreenPosition.set(n.screenX,n.screenY),this.domElement.addEventListener("mousemove",this)):this.domElement.removeEventListener("mousemove",this)}handleAuxiliaryPointerButton(n,i){}handleSecondaryPointerButton(n,i){}handlePointerButtonEvent(n,i){n.preventDefault();switch(n.button){case m.MAIN:this.handleMainPointerButton(n,i);break;case m.AUXILIARY:this.handleAuxiliaryPointerButton(n,i);break;case m.SECONDARY:this.handleSecondaryPointerButton(n,i);break}}handleTouchEvent(n,i){let e=n.touches[0];n.preventDefault(),i?(this.lastScreenPosition.set(e.screenX,e.screenY),this.domElement.addEventListener("touchmove",this)):this.domElement.removeEventListener("touchmove",this)}handleKeyboardEvent(n,i){let e=this.settings.keyBindings;e.has(n.keyCode)&&(n.preventDefault(),this.strategies.get(e.get(n.keyCode)).execute(i))}handleWheelEvent(n){this.rotationManager.zoom(Math.sign(n.deltaY))}handlePointerLockEvent(){document.pointerLockElement===this.domElement?this.domElement.addEventListener("mousemove",this):this.domElement.removeEventListener("mousemove",this)}handleEvent(n){switch(n.type){case"mousemove":this.handlePointerMoveEvent(n);break;case"touchmove":this.handleTouchMoveEvent(n);break;case"mousedown":this.handlePointerButtonEvent(n,!0);break;case"mouseup":this.handlePointerButtonEvent(n,!1);break;case"touchstart":this.handleTouchEvent(n,!0);break;case"touchend":this.handleTouchEvent(n,!1);break;case"keydown":this.handleKeyboardEvent(n,!0);break;case"keyup":this.handleKeyboardEvent(n,!1);break;case"wheel":this.handleWheelEvent(n);break;case"pointerlockchange":this.handlePointerLockEvent();break}}update(n){this.rotationManager.update(n),this.translationManager.update(n)}moveTo(n){return this.translationManager.moveTo(n),this}lookAt(n){return this.rotationManager.lookAt(n),this}setPointerLocked(n=!0){n?document.pointerLockElement!==this.domElement&&this.domElement.requestPointerLock!==void 0&&this.domElement.requestPointerLock():document.exitPointerLock!==void 0&&document.exitPointerLock()}setEnabled(n=!0){let i=this.domElement;return this.translationManager.movementState.reset(),n&&!this.enabled?(document.addEventListener("pointerlockchange",this),document.body.addEventListener("keyup",this),document.body.addEventListener("keydown",this),i.addEventListener("mousedown",this),i.addEventListener("mouseup",this),i.addEventListener("touchstart",this),i.addEventListener("touchend",this),i.addEventListener("wheel",this)):!n&&this.enabled&&(document.removeEventListener("pointerlockchange",this),document.body.removeEventListener("keyup",this),document.body.removeEventListener("keydown",this),i.removeEventListener("mousedown",this),i.removeEventListener("mouseup",this),i.removeEventListener("touchstart",this),i.removeEventListener("touchend",this),i.removeEventListener("wheel",this),i.removeEventListener("mousemove",this),i.removeEventListener("touchmove",this)),this.setPointerLocked(!1),this.enabled=n,this}dispose(){this.setEnabled(!1)}};return $;})();
